<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إدارة الحضور المدرسي</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- الصفحة الرئيسية -->
    <div id="homePage" class="page active">
        <div class="container">
            <div class="text-center py-5">
                <div class="logo mb-4">
                    <i class="bi bi-journal-check display-1 text-primary"></i>
                </div>
                <h1 class="display-4 mb-4">نظام إدارة الحضور</h1>
                <p class="lead mb-5">تسجيل دخول المعلم</p>
                
                <div class="row justify-content-center">
                    <div class="col-md-6 col-lg-4">
                        <div class="card interface-card h-100 glass-effect light-effect hover-lift gpu-accelerated">
                            <div class="card-body text-center">
                                <i class="bi bi-person-check display-1 animate-pulse mb-4"></i>
                                <h3 class="card-title mb-4 text-gradient">دخول المعلم</h3>
                                <p class="card-text mb-4">تحضير الطلاب وإدارة الحصص</p>
                                <button class="btn btn-success btn-lg" id="teacherLoginBtn">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>
                                    تسجيل الدخول
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- رابط خفي لواجهة الإدارة -->
                <div class="mt-5">
                    <small class="text-muted">
                        <a href="#" id="adminSecretLink" class="text-decoration-none text-muted" style="opacity: 0.3;">
                            <small>إدارة النظام</small>
                        </a>
                    </small>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة تسجيل دخول المعلم -->
    <div id="teacherLogin" class="page">
        <div class="container">
            <div class="row justify-content-center min-vh-100 align-items-center">
                <div class="col-md-6 col-lg-4">
                    <div class="card shadow">
                        <div class="card-body p-4">
                            <div class="text-center mb-4">
                                <i class="bi bi-person-check display-3 text-success"></i>
                                <h2 class="mt-3">دخول المعلم</h2>
                            </div>
                            <form id="teacherLoginForm">
                                <div class="mb-3">
                                    <label class="form-label">رقم الهوية</label>
                                    <input type="text" class="form-control" id="teacherNationalId" placeholder="ادخل رقم الهوية (10 أرقام)" maxlength="10" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">كلمة المرور</label>
                                    <input type="password" class="form-control" id="teacherPassword" placeholder="ادخل كلمة المرور" required>
                                </div>
                                <button type="submit" class="btn btn-success w-100 mb-3" id="teacherSubmitBtn">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>دخول
                                </button>
                                <button type="button" class="btn btn-outline-secondary w-100" id="backToHomeFromTeacher">
                                    <i class="bi bi-arrow-right me-2"></i>العودة للرئيسية
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة تسجيل دخول الإدارة -->
    <div id="adminLogin" class="page">
        <div class="container">
            <div class="row justify-content-center min-vh-100 align-items-center">
                <div class="col-md-6 col-lg-4">
                    <div class="card shadow">
                        <div class="card-body p-4">
                            <div class="text-center mb-4">
                                <i class="bi bi-gear display-3 text-primary"></i>
                                <h2 class="mt-3">دخول الإدارة</h2>
                            </div>
                            <form id="adminLoginForm">
                                <div class="mb-3">
                                    <label class="form-label">رقم الهوية</label>
                                    <input type="text" class="form-control" id="adminNationalId" placeholder="1234567890" maxlength="10" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">كلمة المرور</label>
                                    <input type="password" class="form-control" id="adminPassword" placeholder="123456" required>
                                </div>
                                <button type="submit" class="btn btn-primary w-100 mb-3" id="adminSubmitBtn">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>دخول
                                </button>
                                <button type="button" class="btn btn-outline-secondary w-100" id="backToHomeFromAdmin">
                                    <i class="bi bi-arrow-right me-2"></i>العودة للرئيسية
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- لوحة تحكم المعلم -->
    <div id="teacherDashboard" class="page">
        <!-- شريط التنقل العلوي -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-success">
            <div class="container">
                <span class="navbar-brand">
                    <i class="bi bi-person-check me-2"></i>لوحة تحكم المعلم
                </span>
                
                <!-- زر القائمة للشاشات الصغيرة -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#teacherNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                
                <div class="collapse navbar-collapse" id="teacherNavbar">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="#" id="teacherHomeLink">
                                <i class="bi bi-house me-1"></i>الرئيسية
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" id="teacherScheduleLink" onclick="showTeacherSchedule()">
                                <i class="bi bi-calendar-week me-1"></i>الجدول الخاص بي
                            </a>
                        </li>
                    </ul>
                    
                    <div class="navbar-nav">
                        <div class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="teacherDropdown" role="button" data-bs-toggle="dropdown">
                                <i class="bi bi-person-circle me-2"></i>
                                <span id="teacherName">أحمد محمد</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li>
                                    <a class="dropdown-item" href="#" id="teacherProfileLink">
                                        <i class="bi bi-person me-2"></i>الملف الشخصي
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#" id="teacherSettingsLink">
                                        <i class="bi bi-gear me-2"></i>الإعدادات
                                    </a>
                                </li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <a class="dropdown-item text-danger" href="#" id="teacherLogoutBtn">
                                        <i class="bi bi-box-arrow-right me-2"></i>تسجيل الخروج
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="container mt-4">
            <!-- معلومات اليوم -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col">
                            <h5 class="text-muted">اليوم</h5>
                            <h4 id="currentDay">الأحد</h4>
                        </div>
                        <div class="col">
                            <h5 class="text-muted">التاريخ</h5>
                            <h4 id="currentDate">7 سبتمبر 2025</h4>
                        </div>
                        <div class="col">
                            <h5 class="text-muted">الوقت</h5>
                            <h4 id="currentTime">22:00</h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- الحصص اليوم -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0" id="cardTitle"><i class="bi bi-calendar-check me-2"></i>حصص اليوم</h5>
                    <button class="btn btn-outline-secondary btn-sm" id="backToClassesBtn" style="display: none;" onclick="hideScheduleSection()">
                        <i class="bi bi-arrow-left me-1"></i>العودة
                    </button>
                </div>
                <div class="card-body">
                    <!-- محتوى الحصص اليومية -->
                    <div id="classesList" class="row g-3">
                        <!-- سيتم ملؤها بواسطة JavaScript -->
                    </div>
                    
                    <!-- محتوى الجدول الأسبوعي -->
                    <div id="scheduleContainer" style="display: none;">
                        <!-- الجدول سيظهر هنا -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة التحضير -->
    <div id="attendancePage" class="page">
        <!-- شريط التنقل -->
        <nav class="navbar navbar-dark bg-success">
            <div class="container">
                <button class="btn btn-outline-light" id="backToDashboardBtn">
                    <i class="bi bi-arrow-right"></i>
                </button>
                <span class="navbar-brand mx-auto">
                    <i class="bi bi-journal-check me-2"></i>تحضير الطلاب
                </span>
                <div style="width: 48px;"></div>
            </div>
        </nav>

        <div class="container mt-3">
            <!-- معلومات الحصة -->
            <div class="card mb-3">
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col">
                            <h6 class="text-muted mb-1">المادة</h6>
                            <h5 id="currentSubject">الرياضيات</h5>
                        </div>
                        <div class="col">
                            <h6 class="text-muted mb-1">الصف</h6>
                            <h5 id="currentClass">الصف الأول أ</h5>
                        </div>
                        <div class="col">
                            <h6 class="text-muted mb-1">الوقت</h6>
                            <h5 id="classTime">08:00 - 09:00</h5>
                        </div>
                    </div>
                </div>
            </div>

            <!-- إحصائيات الحضور -->
            <div class="row mb-3">
                <div class="col-6">
                    <div class="card bg-success text-white">
                        <div class="card-body text-center">
                            <h2 id="presentCount">0</h2>
                            <small>حاضر</small>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card bg-danger text-white">
                        <div class="card-body text-center">
                            <h2 id="absentCount">0</h2>
                            <small>غائب</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- قائمة الطلاب -->
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0"><i class="bi bi-people me-2"></i>قائمة الطلاب</h6>
                </div>
                <div class="card-body p-2">
                    <div id="studentsList" class="list-group list-group-flush">
                        <!-- سيتم ملؤها بواسطة JavaScript -->
                    </div>
                </div>
            </div>

            <!-- أزرار الإجراء -->
            <div class="d-grid gap-2">
                <button class="btn btn-primary btn-lg" id="saveAttendanceBtn">
                    <i class="bi bi-check-circle me-2"></i>حفظ وإرسال للإدارة
                </button>
            </div>
        </div>
    </div>

    <!-- لوحة تحكم الإدارة -->
    <div id="adminDashboard" class="page">
        <!-- شريط التنقل العلوي -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <span class="navbar-brand">
                    <i class="bi bi-gear me-2"></i>لوحة تحكم الإدارة
                </span>
                <div class="navbar-nav ms-auto">
                    <span class="navbar-text me-3">المدير</span>
                    <button class="btn btn-outline-light btn-sm" id="adminLogoutBtn">
                        <i class="bi bi-box-arrow-right"></i> خروج
                    </button>
                </div>
            </div>
        </nav>

        <div class="container mt-4">
            <!-- الإحصائيات العامة -->
            <div class="row mb-4">
                <div class="col-6 col-md-3 mb-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-people display-4 text-primary"></i>
                            <h3 class="mt-2" id="total-students">0</h3>
                            <small class="text-muted">إجمالي الطلاب</small>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-3 mb-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-check-circle display-4 text-success"></i>
                            <h3 class="mt-2" id="present-today">0</h3>
                            <small class="text-muted">حضور اليوم</small>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-3 mb-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-x-circle display-4 text-danger"></i>
                            <h3 class="mt-2" id="absent-today">0</h3>
                            <small class="text-muted">غياب اليوم</small>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-3 mb-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="bi bi-person-workspace display-4 text-info"></i>
                            <h3 class="mt-2" id="total-teachers">0</h3>
                            <small class="text-muted">المعلمين</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- القائمة الجانبية للإدارة -->
            <div class="row">
                <div class="col-md-3 mb-4">
                    <div class="list-group">
                        <button class="list-group-item list-group-item-action active" data-section="overview">
                            <i class="bi bi-speedometer2 me-2"></i>نظرة عامة
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="teachers">
                            <i class="bi bi-person-workspace me-2"></i>إدارة المعلمين
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="students">
                            <i class="bi bi-people me-2"></i>إدارة الطلاب
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="subjects">
                            <i class="bi bi-book me-2"></i>إدارة المواد
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="schedules">
                            <i class="bi bi-clock me-2"></i>إدارة التوقيتات
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="class-schedules">
                            <i class="bi bi-table me-2"></i>جداول الفصول
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="import">
                            <i class="bi bi-file-earmark-excel me-2"></i>استيراد الملفات
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="attendance">
                            <i class="bi bi-journal-check me-2"></i>تقارير الحضور
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="approval">
                            <i class="bi bi-check2-square me-2"></i>اعتماد التحضير
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="late-arrivals">
                            <i class="bi bi-clock-history me-2"></i>إدارة التأخير
                        </button>
                        <button class="list-group-item list-group-item-action" onclick="openWhatsappManager()">
                            <i class="bi bi-whatsapp me-2"></i>إدارة الواتساب
                        </button>
                        <button class="list-group-item list-group-item-action" onclick="openAttendanceReport()">
                            <i class="bi bi-file-earmark-text me-2"></i>كشف الغياب
                        </button>
                        <button class="list-group-item list-group-item-action" data-section="settings">
                            <i class="bi bi-gear me-2"></i>الإعدادات
                        </button>
                    </div>
                </div>
                <div class="col-md-9">
                    <div id="adminContent">
                        <!-- سيتم ملؤها بواسطة JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- تنبيهات Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <!-- ستتم إضافة التنبيهات هنا بواسطة JavaScript -->
    </div>

    <!-- مودال تغيير كلمة المرور -->
    <div class="modal fade" id="changePasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">تغيير كلمة المرور</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="changePasswordForm">
                    <div class="modal-body">
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle me-2"></i>
                            يجب تغيير كلمة المرور المولدة تلقائياً لأول مرة
                        </div>
                        <div class="mb-3">
                            <label class="form-label">كلمة المرور الحالية</label>
                            <input type="password" class="form-control" id="currentPassword" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">كلمة المرور الجديدة</label>
                            <input type="password" class="form-control" id="newPassword" minlength="6" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">تأكيد كلمة المرور الجديدة</label>
                            <input type="password" class="form-control" id="confirmPassword" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">تغيير كلمة المرور</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- مودال إضافة معلم جديد -->
    <div class="modal fade" id="addTeacherModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">إضافة معلم جديد</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="addTeacherForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">اسم المعلم</label>
                            <input type="text" class="form-control" id="addTeacherName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">رقم الهوية</label>
                            <input type="text" class="form-control" id="teacherNationalIdAdd" maxlength="10" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">رقم الهاتف</label>
                            <input type="tel" class="form-control" id="teacherPhone">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إضافة المعلم</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- مودال إضافة مادة جديدة -->
    <div class="modal fade" id="addSubjectModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">إضافة مادة جديدة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="addSubjectForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">اسم المادة</label>
                            <input type="text" class="form-control" id="addSubjectName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">الاسم بالإنجليزية</label>
                            <input type="text" class="form-control" id="addSubjectNameEn" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">الوصف (اختياري)</label>
                            <textarea class="form-control" id="addSubjectDescription" rows="3" placeholder="وصف مختصر عن المادة"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إضافة المادة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- مودال إضافة طالب جديد -->
    <div class="modal fade" id="addStudentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">إضافة طالب جديد</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="addStudentForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">اسم الطالب</label>
                            <input type="text" class="form-control" id="addStudentName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">رقم الهوية/رقم الطالب</label>
                            <input type="text" class="form-control" id="studentNationalId" maxlength="10" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">الصف</label>
                                    <select class="form-control" id="studentGrade" required>
                                        <option value="">اختر الصف</option>
                                        <option value="الصف الأول">الصف الأول</option>
                                        <option value="الصف الثاني">الصف الثاني</option>
                                        <option value="الصف الثالث">الصف الثالث</option>
                                        <option value="الصف الرابع">الصف الرابع</option>
                                        <option value="الصف الخامس">الصف الخامس</option>
                                        <option value="الصف السادس">الصف السادس</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">الشعبة</label>
                                    <input type="text" class="form-control" id="studentClassName" placeholder="مثال: أ، ب، ج" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">اسم ولي الأمر</label>
                            <input type="text" class="form-control" id="studentParentName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">هاتف ولي الأمر</label>
                            <input type="tel" class="form-control" id="studentPhone" placeholder="05xxxxxxxx" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إضافة الطالب</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- مودال إضافة حصة جديدة -->
    <div class="modal fade" id="addClassModal" tabindex="-1">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">إضافة حصة جديدة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="addClassForm">
                    <div class="modal-body">
                        <!-- معلومات الموقع في الجدول -->
                        <div class="alert alert-info mb-3" id="sessionLocationInfo">
                            <i class="bi bi-info-circle me-2"></i>
                            <span id="sessionLocationText"></span>
                        </div>
                        
                        <!-- الحقول المطلوبة فقط -->
                        <div class="mb-3">
                            <label class="form-label">المعلم <span class="text-danger">*</span></label>
                            <select class="form-control" id="classTeacherId" required>
                                <option value="">اختر المعلم</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">المادة <span class="text-danger">*</span></label>
                            <select class="form-control" id="classSubjectId" required>
                                <option value="">اختر المادة</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">ملاحظات (اختياري)</label>
                            <textarea class="form-control" id="classNotes" rows="2" placeholder="أي ملاحظات إضافية..."></textarea>
                        </div>
                        
                        <!-- الحقول المخفية -->
                        <input type="hidden" id="classGrade">
                        <input type="hidden" id="className">
                        <input type="hidden" id="classDay">
                        <input type="hidden" id="classPeriodNumber">
                        <input type="hidden" id="selectedScheduleId">
                        <input type="hidden" id="classStartTime">
                        <input type="hidden" id="classEndTime">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-plus-circle me-2"></i>إضافة الحصة
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- مودال عرض كلمة مرور المعلم الجديد -->
    <div class="modal fade" id="teacherPasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">تم إنشاء المعلم بنجاح</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success text-center">
                        <i class="bi bi-check-circle-fill display-4 mb-3"></i>
                        <h4>تم إضافة المعلم بنجاح!</h4>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">بيانات تسجيل الدخول:</h6>
                                    <div class="mb-3">
                                        <label class="form-label"><strong>رقم الهوية:</strong></label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="generatedNationalId" readonly>
                                            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('generatedNationalId')">
                                                <i class="bi bi-clipboard"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label"><strong>كلمة المرور:</strong></label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="generatedPassword" readonly>
                                            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('generatedPassword')">
                                                <i class="bi bi-clipboard"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="alert alert-warning">
                                <i class="bi bi-exclamation-triangle me-2"></i>
                                <strong>تنبيه مهم:</strong>
                                <ul class="mb-0 mt-2">
                                    <li>احفظ هذه البيانات في مكان آمن</li>
                                    <li>سلّم البيانات للمعلم</li>
                                    <li>يجب على المعلم تغيير كلمة المرور في أول تسجيل دخول</li>
                                    <li>لن تظهر كلمة المرور مرة أخرى</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">تم الحفظ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال إضافة صف جديد -->
    <div class="modal fade" id="addGradeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">إضافة صف جديد</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="addGradeForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">اسم الصف</label>
                            <input type="text" class="form-control" id="gradeName" placeholder="مثال: خامس" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">عدد الفصول</label>
                            <input type="number" class="form-control" id="gradeSections" min="1" max="20" value="1" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إضافة الصف</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- إشعار الواجهة الجديدة -->
    <div id="newInterfaceNotification" class="notification-banner">
        <div class="notification-content">
            <div class="notification-header">
                <i class="bi bi-stars text-warning me-2"></i>
                <strong>واجهة جديدة ومطورة متاحة الآن!</strong>
                <button type="button" class="btn-close btn-close-white ms-auto" onclick="hideNotification()"></button>
            </div>
            <div class="notification-body">
                <p class="mb-2">اكتشف المزيد من المميزات الجديدة:</p>
                <ul class="feature-list">
                    <li><i class="bi bi-trophy text-warning me-1"></i> برنامج نقاطي للطلاب</li>
                    <li><i class="bi bi-chat-dots text-info me-1"></i> إرسال رسائل لأولياء الأمور</li>
                    <li><i class="bi bi-graph-up text-success me-1"></i> تقارير تفصيلية متقدمة</li>
                    <li><i class="bi bi-phone text-primary me-1"></i> تصميم محسن للجوال</li>
                </ul>
                <p class="mb-2"><strong>يمكنك الدخول بنفس الهوية وكلمة المرور السابقة</strong></p>
                <div class="notification-actions">
                    <a href="https://alraed.vercel.app/auth/teacher" class="btn btn-warning btn-sm me-2" target="_blank">
                        <i class="bi bi-arrow-up-right-circle me-1"></i>جرب الواجهة الجديدة
                    </a>
                    <button type="button" class="btn btn-outline-light btn-sm" onclick="hideNotification()">
                        لاحقاً
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="api.js"></script>
    <script src="app.js"></script>
    
    <script>
        // إظهار إشعار الواجهة الجديدة
        function showNotification() {
            const notification = document.getElementById('newInterfaceNotification');
            if (!localStorage.getItem('newInterfaceNotificationHidden')) {
                setTimeout(() => {
                    notification.classList.add('show');
                }, 1000); // تأخير ثانية واحدة
            }
        }

        function hideNotification() {
            const notification = document.getElementById('newInterfaceNotification');
            notification.classList.remove('show');
            localStorage.setItem('newInterfaceNotificationHidden', 'true');
        }

        // تحديث الإحصائيات عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', async function() {
            // إظهار الإشعار
            showNotification();
            try {
                // إنشاء instance من ApiService إذا لم يكن موجود
                if (typeof apiService === 'undefined') {
                    window.apiService = new ApiService();
                }
                
                // جلب الإحصائيات
                const result = await apiService.getDashboardStats();
                if (result.success) {
                    const stats = result.data;
                    
                    // تحديث عناصر HTML
                    document.getElementById('total-students').textContent = stats.total_students || 0;
                    document.getElementById('present-today').textContent = stats.present_today || 0;
                    document.getElementById('absent-today').textContent = stats.absent_today || 0;
                    document.getElementById('total-teachers').textContent = stats.total_teachers || 0;
                }
            } catch (error) {
                console.log('خطأ في تحميل الإحصائيات:', error.message);
                // الاحتفاظ بالقيم الافتراضية (0) في حالة الخطأ
            }
        });
    </script>
</body>
</html>